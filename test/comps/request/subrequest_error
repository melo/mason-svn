<%def .helper>
% my $interp = $m->interp;
% $interp->exec('/request/support/subrequest_error_test');
</%def>

Calling helper
% eval {$m->comp('.helper')};
% my $error = $@;
% if ($] == 5.006) { # hack to work around bug in 5.6.0
Error: error while executing /request/support/subrequest_error_test:
whoops! 

% } else {
<& /shared/check_error, error=>$error, lines=>2 &>
% }

% if ($error) {
Back from error, checking request state:
<& support/display_req_obj &>
% }